add logging
review of exceptional cases
add documentation
